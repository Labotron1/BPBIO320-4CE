<!DOCTYPE html>
<html lang="th">
<head>
  <meta charset="UTF-8">
  <title>‡∏ï‡∏±‡∏ß‡∏ä‡πà‡∏ß‡∏¢‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç Error</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <style>
    body {
      font-family: sans-serif;
      padding: 20px;
      background-color: #f8f8f8;
      max-width: 600px;
      margin: auto;
    }

    h1, h2 {
      color: #333;
      font-size: 1.4em;
    }

    input, select, button, textarea {
      padding: 10px;
      margin: 10px 0;
      width: 100%;
      font-size: 16px;
      box-sizing: border-box;
      border-radius: 5px;
      border: 1px solid #ccc;
    }

    button {
      background-color: #007bff;
      color: white;
      border: none;
      cursor: pointer;
    }

    button:hover {
      background-color: #0056b3;
    }

    #result {
      margin-top: 20px;
      background: #fff3cd;
      padding: 15px;
      border-left: 5px solid #ffcc00;
      border-radius: 5px;
    }

    hr {
      margin: 30px 0;
    }

    @media (max-width: 480px) {
      body {
        padding: 10px;
      }

      h1, h2 {
        font-size: 1.2em;
      }

      button {
        font-size: 16px;
      }
    }
  </style>

  <!-- Firebase SDK -->
  <script src="https://www.gstatic.com/firebasejs/10.12.2/firebase-app.js"></script>
  <script src="https://www.gstatic.com/firebasejs/10.12.2/firebase-firestore.js"></script>
</head>
<body>

  <h1>üìò ‡∏ï‡∏±‡∏ß‡∏ä‡πà‡∏ß‡∏¢‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç Error ‡πÄ‡∏ö‡∏∑‡πâ‡∏≠‡∏á‡∏ï‡πâ‡∏ô</h1>

  <label for="errorInput">üîç ‡∏û‡∏¥‡∏°‡∏û‡πå‡∏ä‡∏∑‡πà‡∏≠ error ‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤:</label>
  <input type="text" id="errorInput" placeholder="‡πÄ‡∏ä‡πà‡∏ô E01">

  <label for="errorSelect">‡∏´‡∏£‡∏∑‡∏≠‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏à‡∏≤‡∏Å‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£ error ‡∏ó‡∏µ‡πà‡∏Ñ‡∏∏‡∏ì‡πÄ‡∏Ñ‡∏¢‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÑ‡∏ß‡πâ:</label>
  <select id="errorSelect">
    <option value="">-- ‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÇ‡∏´‡∏•‡∏î Error --</option>
  </select>

  <button onclick="showSolution()">‡∏î‡∏π‡∏ß‡∏¥‡∏ò‡∏µ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç</button>
  <button onclick="editError()">‚úèÔ∏è ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç Error ‡∏ó‡∏µ‡πà‡πÄ‡∏•‡∏∑‡∏≠‡∏Å</button>
  <button onclick="deleteError()">üóë ‡∏•‡∏ö Error ‡∏ó‡∏µ‡πà‡πÄ‡∏•‡∏∑‡∏≠‡∏Å</button>

  <div id="result"></div>

  <hr>

  <h2>üîê ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• Error (‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡πÄ‡∏à‡πâ‡∏≤‡∏Ç‡∏≠‡∏á‡πÄ‡∏ó‡πà‡∏≤‡∏ô‡∏±‡πâ‡∏ô)</h2>

  <label for="adminPassword">‡πÉ‡∏™‡πà‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•:</label>
  <input type="password" id="adminPassword" placeholder="‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•">
  <label><input type="checkbox" id="showPass"> ‡πÅ‡∏™‡∏î‡∏á‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô</label>
  <button onclick="clearPassword()">‡∏•‡πâ‡∏≤‡∏á‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô</button>

  <input type="text" id="newErrorName" placeholder="‡∏ä‡∏∑‡πà‡∏≠ Error ‡πÉ‡∏´‡∏°‡πà ‡πÄ‡∏ä‡πà‡∏ô MyError123" disabled>
  <textarea id="newErrorSolution" rows="4" placeholder="‡πÉ‡∏™‡πà‡∏ß‡∏¥‡∏ò‡∏µ‡∏Å‡∏≤‡∏£‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡∏Ç‡∏≠‡∏á Error ‡∏ô‡∏µ‡πâ" disabled></textarea>
  <button id="addBtn" onclick="addNewError()" disabled>‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•</button>

  <script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-app.js";
    import { getFirestore, collection, doc, setDoc, getDoc, getDocs, deleteDoc } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-firestore.js";

    // ‚úÖ Firebase Config ‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì
    const firebaseConfig = {
      apiKey: "AIzaSyCkZgPoug4gJAOsrbqpvjGyKr8Q3RrmokE",
      authDomain: "bpbio320-89c27.firebaseapp.com",
      projectId: "bpbio320-89c27",
      storageBucket: "bpbio320-89c27.firebasestorage.app",
      messagingSenderId: "449529387736",
      appId: "1:449529387736:web:dc9ba687a8ff32d8d715ad",
      measurementId: "G-2J6Z0JPCXC"
    };

    const app = initializeApp(firebaseConfig);
    const db = getFirestore(app);
    const correctPassword = "132546"; // üîí ‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡πÑ‡∏î‡πâ‡∏ï‡∏≤‡∏°‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£

    async function updateErrorDropdown() {
      const select = document.getElementById("errorSelect");
      select.innerHTML = '<option value="">-- ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å Error --</option>';
      const querySnapshot = await getDocs(collection(db, "errors"));
      querySnapshot.forEach((docSnap) => {
        const option = document.createElement("option");
        option.value = docSnap.id;
        option.text = docSnap.id;
        select.appendChild(option);
      });
    }

    async function showSolution() {
      const input = document.getElementById("errorInput").value.trim();
      const selected = document.getElementById("errorSelect").value;
      const errorName = input || selected;
      const resultBox = document.getElementById("result");

      if (!errorName) {
        resultBox.innerHTML = "<strong>‚ö†Ô∏è ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÉ‡∏™‡πà‡∏´‡∏£‡∏∑‡∏≠‡πÄ‡∏•‡∏∑‡∏≠‡∏Å error ‡∏Å‡πà‡∏≠‡∏ô</strong>";
        return;
      }

      const docRef = doc(db, "errors", errorName);
      const docSnap = await getDoc(docRef);

      if (docSnap.exists()) {
        resultBox.innerHTML = `<strong>üõ† ‡∏ß‡∏¥‡∏ò‡∏µ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö "${errorName}":</strong><br>${docSnap.data().solution}`;
      } else {
        resultBox.innerHTML = `<strong>‚ùå ‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Ç‡∏≠‡∏á "${errorName}"</strong>`;
      }
    }

    async function addNewError() {
      const name = document.getElementById("newErrorName").value.trim();
      const solution = document.getElementById("newErrorSolution").value.trim();
      const resultBox = document.getElementById("result");

      if (!name || !solution) {
        resultBox.innerHTML = "<strong>‚ö†Ô∏è ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å‡∏ä‡∏∑‡πà‡∏≠ error ‡πÅ‡∏•‡∏∞‡∏ß‡∏¥‡∏ò‡∏µ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡πÉ‡∏´‡πâ‡∏Ñ‡∏£‡∏ö</strong>";
        return;
      }

      const docRef = doc(db, "errors", name);
      const docSnap = await getDoc(docRef);
      if (docSnap.exists()) {
        resultBox.innerHTML = `<strong>‚ö†Ô∏è ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• "${name}" ‡∏°‡∏µ‡∏≠‡∏¢‡∏π‡πà‡πÅ‡∏•‡πâ‡∏ß</strong>`;
        return;
      }

      await setDoc(docRef, { solution });
      updateErrorDropdown();
      resultBox.innerHTML = `<strong>‚úÖ ‡πÄ‡∏û‡∏¥‡πà‡∏° "${name}" ‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢‡πÅ‡∏•‡πâ‡∏ß!</strong>`;
      document.getElementById("newErrorName").value = "";
      document.getElementById("newErrorSolution").value = "";
    }

    async function deleteError() {
      const selected = document.getElementById("errorSelect").value;
      const resultBox = document.getElementById("result");

      if (!selected) {
        resultBox.innerHTML = "<strong>‚ö†Ô∏è ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÄ‡∏•‡∏∑‡∏≠‡∏Å error ‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏•‡∏ö</strong>";
        return;
      }

      const confirmed = confirm(`‡∏Ñ‡∏∏‡∏ì‡πÅ‡∏ô‡πà‡πÉ‡∏à‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà‡∏ß‡πà‡∏≤‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏•‡∏ö "${selected}"?`);
      if (!confirmed) return;

      await deleteDoc(doc(db, "errors", selected));
      updateErrorDropdown();
      resultBox.innerHTML = `<strong>üóë ‡∏•‡∏ö "${selected}" ‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢‡πÅ‡∏•‡πâ‡∏ß</strong>`;
    }

    async function editError() {
      const selected = document.getElementById("errorSelect").value;
      const resultBox = document.getElementById("result");

      if (!selected) {
        resultBox.innerHTML = "<strong>‚ö†Ô∏è ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÄ‡∏•‡∏∑‡∏≠‡∏Å error ‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç</strong>";
        return;
      }

      const docRef = doc(db, "errors", selected);
      const docSnap = await getDoc(docRef);
      if (!docSnap.exists()) {
        resultBox.innerHTML = `<strong>‚ùå ‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• "${selected}"</strong>`;
        return;
      }

      const newSolution = prompt(`‚úèÔ∏è ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡∏ß‡∏¥‡∏ò‡∏µ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö "${selected}"`, docSnap.data().solution);
      if (newSolution !== null) {
        await setDoc(docRef, { solution: newSolution });
        result
